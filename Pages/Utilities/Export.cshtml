@page
@model ExportModel
@{
    ViewData["Title"] = "Database Export";
}

<div class="container d-flex justify-content-center align-items-center min-vh-100">
    <div class="card shadow-lg p-4 rounded-4" style="width: 100%; max-width: 500px;">
        <a title="Close" class="text-danger " style="cursor: pointer;" onclick="window.location = '/';">
            <i class="fas fa-window-close fa-2xl float-end"></i>
        </a>
        <div class="card-body text-center">
            <h4 class="mb-4 text-primary"><i class="fas fa-database me-2"></i>Export Database</h4>

            @if (TempData["Success"] != null)
            {
                <div class="alert alert-success">
                    <i class="fas fa-check-circle me-2"></i> @TempData["Success"]
                </div>
            }
            @if (TempData["Error"] != null)
            {
                <div class="alert alert-danger">
                    <i class="fas fa-exclamation-circle me-2"></i> @TempData["Error"]
                </div>
            }

            <p class="text-muted mb-4">Click the button below to export all table data from the database as CSV files.</p>

            <form method="post" onsubmit="return confirmExport();">
                <div class="mb-3">
                    <button id="exportBtn" type="submit" class="btn btn-outline-primary px-4">
                        <i class="fas fa-download me-2"></i> Export Now
                    </button>
                </div>

                <div id="progressContainer" class="progress" style="height: 20px; display: none;">
                    <div class="progress-bar progress-bar-striped progress-bar-animated bg-success"
                         role="progressbar"
                         style="width: 100%">
                        Exporting...
                    </div>
                </div>
            </form>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        function confirmExport() {
            if (confirm("Are you sure you want to export all tables as CSV?")) {
                document.getElementById("exportBtn").disabled = true;
                document.getElementById("progressContainer").style.display = "block";
                return true;
            }
            return false;
        }
    </script>
}
